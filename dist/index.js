!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.WeRegion=e()}(this,function(){"use strict";"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t,e){!function(e,i){t.exports=i()}(0,function(){var t=[];return{requestAnimationFrame:function(e){var i=t.find(function(t){return t.callback===e});if(i)return i.requestId;var n=window.requestAnimationFrame(function(i){var n=t.findIndex(function(t){return t.callback===e});t.splice(n,1),e(i)});return t.push({callback:e,requestId:n}),n},cancelAnimationFrame:function(e){var i=t.findIndex(function(t){return t.requestId===e});return-1!==i&&t.splice(i,1),window.cancelAnimationFrame(e)}}})}).requestAnimationFrame,e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();return function(){function n(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(this,n);var o={width:0,height:0,borderColor:"#0099FF",bodyColor:"rgba(195, 213, 237, 0.6)",lineDash:[4,2],zIndex:9527,move:void 0,end:void 0},s="string"==typeof t?document.querySelector(t):t;if(void 0===s)throw new Error("A element or dom selector must be passed");Object.assign(this,{canvas:s,ctx:s.getContext("2d"),canvasClientRect:s.getBoundingClientRect(),options:Object.assign({},o,i,{width:parseFloat(i.width)||s.parentNode.clientWidth,height:parseFloat(i.height)||s.parentNode.clientHeight}),hasMouseDown:!1}),this._initCanvas(),this._initEvents()}return i(n,[{key:"_initCanvas",value:function(){var t=this.ctx,e=this.options,i=e.bodyColor,n=e.borderColor,o=e.lineDash;this._initCanvasSize(),t.fillStyle=i,t.strokeStyle=n,t.setLineDash(o)}},{key:"_initCanvasSize",value:function(){var t=this.canvas,e=this.ctx,i=this.options,n=i.width,o=i.height,s=i.zIndex,a=window.devicePixelRatio||1;t.width=n*a,t.height=o*a,e.scale(a,a),t.style.cssText="width:"+n+"px;height:"+o+"px;position:absolute;z-index:"+s}},{key:"_initEvents",value:function(){var t=this.canvas;t.addEventListener("mousedown",this._onMouseDown.bind(this),!1),t.addEventListener("mousemove",this._onMouseMove.bind(this),!1),t.addEventListener("mouseup",this._onMouseUp.bind(this),!1),t.addEventListener("mouseleave",this._onMouseLeave.bind(this),!1)}},{key:"_onMouseDown",value:function(t){this.hasMouseDown=!0,this.canvasClientRect=this.canvas.getBoundingClientRect();var e=this.canvasClientRect,i=e.top,n=e.left,o=this.startX=this.moveX=t.clientX-n,s=this.startY=this.moveY=t.clientY-i;this._strokRect({startX:o,startY:s})}},{key:"_onMouseMove",value:function(t){if(this.hasMouseDown){var e=this.canvasClientRect,i=e.top,n=e.left,o=this.moveX=t.clientX-n,s=this.moveY=t.clientY-i;this._strokRect({moveX:o,moveY:s})}}},{key:"_onMouseUp",value:function(){if(this.hasMouseDown){this.hasMouseDown=!1;var t=this.startX,e=this.startY,i=this.moveX,n=this.moveY,o=this.width=i-t,s=this.height=n-e;"function"==typeof this.options.end&&this.options.end({startX:t,startY:e,width:o,height:s}),this.clear()}}},{key:"_onMouseLeave",value:function(){this._onMouseUp()}},{key:"_strokRect",value:function(e){var i=this,n=e.moveX,o=e.moveY;t(function(){var t=i.ctx,e=i.startX,s=i.startY;i.clear();var a=i.width=n-e,r=i.height=o-s;t.strokeRect(e,s,a,r),t.fillRect(e,s,a,r),"function"==typeof i.options.move&&i.options.move({startX:e,startY:s,width:a,height:r})})}},{key:"clear",value:function(){var t=this.canvas;this.ctx.clearRect(0,0,t.width,t.height)}},{key:"isRectCross",value:function(t,e){e||(e={x:this.startX,y:this.startY,width:this.width,height:this.height});var i=t.x,n=t.y,o=t.width,s=t.height,a=e,r=a.x,h=a.y,u=a.width,c=a.height,d=o/2+i,l=s/2+n,v=u/2+r,f=c/2+h,p=Math.abs(v-d)<=Math.abs(o/2)+Math.abs(u/2),w=Math.abs(f-l)<=Math.abs(s/2)+Math.abs(c/2);return p&&w}}]),n}()});
