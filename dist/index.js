!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.WeRegion=e()}(this,function(){"use strict";"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var t=function(t,e){return e={exports:{}},t(e,e.exports),e.exports}(function(t,e){!function(e,n){t.exports=n()}(0,function(){var t=[];return{requestAnimationFrame:function(e){var n=t.find(function(t){return t.callback===e});if(n)return n.requestId;var i=window.requestAnimationFrame(function(n){var i=t.findIndex(function(t){return t.callback===e});t.splice(i,1),e(n)});return t.push({callback:e,requestId:i}),i},cancelAnimationFrame:function(e){var n=t.findIndex(function(t){return t.requestId===e});return-1!==n&&t.splice(n,1),window.cancelAnimationFrame(e)}}})}).requestAnimationFrame,e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();return function(){function i(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(this,i);var o={width:0,height:0,borderColor:"#0099FF",bodyColor:"rgba(195, 213, 237, 0.6)",lineDash:[4,2],zIndex:9527,move:void 0,end:void 0},s="string"==typeof t?document.querySelector(t):t;if(void 0===s)throw new Error("A element or dom selector must be passed");Object.assign(this,{canvas:s,ctx:s.getContext("2d"),canvasClientRect:s.getBoundingClientRect(),options:Object.assign({},o,n,{width:parseFloat(n.width)||s.parentNode.clientWidth,height:parseFloat(n.height)||s.parentNode.clientHeight}),hasMouseDown:!1}),this._initCanvas(),this._initEvents()}return n(i,[{key:"_initCanvas",value:function(){var t=this.ctx,e=this.options,n=e.bodyColor,i=e.borderColor,o=e.lineDash;this._initCanvasSize(),t.fillStyle=n,t.strokeStyle=i,t.setLineDash(o)}},{key:"_initCanvasSize",value:function(){var t=this.canvas,e=this.ctx,n=this.options,i=n.width,o=n.height,s=n.zIndex,a=window.devicePixelRatio||1;t.width=i*a,t.height=o*a,e.scale(a,a),t.style.cssText="width:"+i+"px;height:"+o+"px;position:absolute;z-index:"+s}},{key:"_initEvents",value:function(){var t=this.canvas;t.addEventListener("mousedown",this._onMouseDown.bind(this),!1),t.addEventListener("mousemove",this._onMouseMove.bind(this),!1),t.addEventListener("mouseup",this._onMouseUp.bind(this),!1),t.addEventListener("mouseleave",this._onMouseLeave.bind(this),!1)}},{key:"_onMouseDown",value:function(t){this.hasMouseDown=!0,this.canvasClientRect=this.canvas.getBoundingClientRect();var e=this.canvasClientRect,n=e.top,i=e.left,o=this.startX=this.moveX=t.clientX-i,s=this.startY=this.moveY=t.clientY-n;this._strokRect({startX:o,startY:s})}},{key:"_onMouseMove",value:function(t){if(this.hasMouseDown){var e=this.canvasClientRect,n=e.top,i=e.left,o=this.moveX=t.clientX-i,s=this.moveY=t.clientY-n;this._strokRect({moveX:o,moveY:s})}}},{key:"_onMouseUp",value:function(){if(this.hasMouseDown){this.hasMouseDown=!1;var t=this.startX,e=this.startY,n=this.moveX,i=this.moveY,o=this.width=n-t,s=this.height=i-e;"function"==typeof this.options.end&&this.options.end({startX:t,startY:e,width:o,height:s}),this.clear()}}},{key:"_onMouseLeave",value:function(){this._onMouseUp()}},{key:"_strokRect",value:function(e){var n=this,i=e.moveX,o=e.moveY;t(function(){var t=n.ctx,e=n.startX,s=n.startY;n.clear();var a=n.width=i-e,r=n.height=o-s;t.strokeRect(e,s,a,r),t.fillRect(e,s,a,r),"function"==typeof n.options.move&&n.options.move({startX:e,startY:s,width:a,height:r})})}},{key:"clear",value:function(){var t=this.canvas;this.ctx.clearRect(0,0,t.width,t.height)}},{key:"isRectCross",value:function(t){var e=t.x,n=t.y,i=t.w,o=t.h,s=this.startX,a=this.startY,r=this.width,h=this.height,u=i/2+e,c=o/2+n,l=r/2+s,d=h/2+a,v=Math.abs(l-u)<=i/2+Math.abs(r/2),f=Math.abs(d-c)<=o/2+Math.abs(h/2);return v&&f}}]),i}()});
